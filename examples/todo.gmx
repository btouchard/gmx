<script>
model Task {
  id:         uuid    @pk @default(uuid_v4)
  title:      string  @min(3) @max(255)
  done:       bool    @default(false)
  tenant_id:  uuid    @scoped
  author:     User    @relation(references: [id])
}

func toggleTask(id: uuid) error {
  let task = try Task.find(id)
  task.done = !task.done
  try task.save()
  return render(task)
}

func getTitle(t: Task) string {
  return "TÃ¢che: {t.title}"
}
</script>

<template>
<div class="task-item" id="task-{Task.id}">
  <span class={Task.done ? "line-through" : ""}>
    {getTitle(Task)}
  </span>
  <button
    hx-patch={toggleTask(Task.id)}
    hx-target="closest .task-item"
    hx-swap="outerHTML"
  >
    {Task.done ? "Annuler" : "Terminer"}
  </button>
</div>
</template>

<style scoped>
.task-item { padding: 1rem; border-bottom: 1px solid #eee; }
.completed { opacity: 0.5; }
</style>
